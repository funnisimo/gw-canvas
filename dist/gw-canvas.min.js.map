{"version":3,"file":"gw-canvas.min.js","sources":["../js/utils.js","../js/shaders.js","../js/canvas.js","../js/glyphs.js","../js/config.js","../js/color.js","../js/buffer.js","../js/mixer.js","../js/index.js"],"sourcesContent":["// Copy of: https://github.com/ondras/fastiles/blob/master/ts/utils.ts (v2.1.0)\nexport const QUAD = [\n    0, 0, 1, 0, 0, 1,\n    0, 1, 1, 0, 1, 1\n];\nexport function createProgram(gl, ...sources) {\n    const p = gl.createProgram();\n    [gl.VERTEX_SHADER, gl.FRAGMENT_SHADER].forEach((type, index) => {\n        const shader = gl.createShader(type);\n        gl.shaderSource(shader, sources[index]);\n        gl.compileShader(shader);\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n            throw new Error(gl.getShaderInfoLog(shader));\n        }\n        gl.attachShader(p, shader);\n    });\n    gl.linkProgram(p);\n    if (!gl.getProgramParameter(p, gl.LINK_STATUS)) {\n        throw new Error(gl.getProgramInfoLog(p));\n    }\n    return p;\n}\nexport function createTexture(gl) {\n    let t = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, t);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    return t;\n}\nexport function createGeometry(gl, attribs, width, height) {\n    let tileCount = width * height;\n    let positionData = new Uint16Array(tileCount * QUAD.length);\n    let uvData = new Uint8Array(tileCount * QUAD.length);\n    let i = 0;\n    for (let y = 0; y < height; y++) {\n        for (let x = 0; x < width; x++) {\n            QUAD.forEach(value => {\n                positionData[i] = (i % 2 ? y : x) + value;\n                uvData[i] = value;\n                i++;\n            });\n        }\n    }\n    const position = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, position);\n    gl.vertexAttribIPointer(attribs[\"position\"], 2, gl.UNSIGNED_SHORT, 0, 0);\n    gl.bufferData(gl.ARRAY_BUFFER, positionData, gl.STATIC_DRAW);\n    const uv = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, uv);\n    gl.vertexAttribIPointer(attribs[\"uv\"], 2, gl.UNSIGNED_BYTE, 0, 0);\n    gl.bufferData(gl.ARRAY_BUFFER, uvData, gl.STATIC_DRAW);\n    return { position, uv };\n}\n","// Based on: https://github.com/ondras/fastiles/blob/master/ts/shaders.ts (v2.1.0)\nexport const VS = `\n#version 300 es\nin uvec2 position;\nin uvec2 uv;\nin uint style;\nout vec2 fsUv;\nflat out uint fsStyle;\nuniform highp uvec2 tileSize;\nuniform uvec2 viewportSize;\nvoid main() {\n\tivec2 positionPx = ivec2(position * tileSize);\n\tvec2 positionNdc = (vec2(positionPx * 2) / vec2(viewportSize))-1.0;\n\tpositionNdc.y *= -1.0;\n\tgl_Position = vec4(positionNdc, 0.0, 1.0);\n\tfsUv = vec2(uv);\n\tfsStyle = style;\n}`.trim();\nexport const FS = `\n#version 300 es\nprecision highp float;\nin vec2 fsUv;\nflat in uint fsStyle;\nout vec4 fragColor;\nuniform sampler2D font;\nuniform highp uvec2 tileSize;\nvoid main() {\n\tuvec2 fontTiles = uvec2(textureSize(font, 0)) / tileSize;\n\n\tuint glyph = (fsStyle & uint(0xFF000000)) >> 24;\n\tuint glyphX = (glyph & uint(0xF));\n\tuint glyphY = (glyph >> 4);\n\tuvec2 fontPosition = uvec2(glyphX, glyphY);\n\n\tuvec2 fontPx = (tileSize * fontPosition) + uvec2(vec2(tileSize) * fsUv);\n\tvec3 texel = texelFetch(font, ivec2(fontPx), 0).rgb;\n\n\tfloat s = 15.0;\n\tuint fr = (fsStyle & uint(0xF00)) >> 8;\n\tuint fg = (fsStyle & uint(0x0F0)) >> 4;\n\tuint fb = (fsStyle & uint(0x00F)) >> 0;\n\tvec3 fgRgb = vec3(fr, fg, fb) / s;\n  \n\tuint br = (fsStyle & uint(0xF00000)) >> 20;\n\tuint bg = (fsStyle & uint(0x0F0000)) >> 16;\n\tuint bb = (fsStyle & uint(0x00F000)) >> 12;\n\tvec3 bgRgb = vec3(br, bg, bb) / s;\n  \n\tfragColor = vec4(mix(bgRgb, fgRgb, texel), 1.0);\n}`.trim();\n","// Based on: https://github.com/ondras/fastiles/blob/master/ts/scene.ts (v2.1.0)\nimport { createProgram, createTexture, createGeometry } from \"./utils\";\nimport * as shaders from \"./shaders\";\nconst VERTICES_PER_TILE = 6;\nexport class NotSupportedError extends Error {\n    constructor(...params) {\n        // Pass remaining arguments (including vendor specific ones) to parent constructor\n        super(...params);\n        // Maintains proper stack trace for where our error was thrown (only available on V8)\n        // @ts-ignore\n        if (Error.captureStackTrace) {\n            // @ts-ignore\n            Error.captureStackTrace(this, NotSupportedError);\n        }\n        this.name = 'NotSupportedError';\n    }\n}\nexport class BaseCanvas {\n    constructor(options) {\n        this._renderRequested = false;\n        this._autoRender = true;\n        this._width = 50;\n        this._height = 25;\n        if (!options.glyphs)\n            throw new Error('You must supply glyphs for the canvas.');\n        this._node = this._createNode();\n        this._createContext();\n        this._configure(options);\n    }\n    get node() { return this._node; }\n    get width() { return this._width; }\n    get height() { return this._height; }\n    get tileWidth() { return this._glyphs.tileWidth; }\n    get tileHeight() { return this._glyphs.tileHeight; }\n    get pxWidth() { return this.node.clientWidth; }\n    get pxHeight() { return this.node.clientHeight; }\n    get glyphs() { return this._glyphs; }\n    set glyphs(glyphs) {\n        this._setGlyphs(glyphs);\n    }\n    _createNode() {\n        return document.createElement(\"canvas\");\n    }\n    _configure(options) {\n        this._width = options.width || this._width;\n        this._height = options.height || this._height;\n        this._autoRender = (options.render !== false);\n        this._setGlyphs(options.glyphs);\n        if (options.div) {\n            let el;\n            if (typeof options.div === 'string') {\n                el = document.getElementById(options.div);\n                if (!el) {\n                    console.warn('Failed to find parent element by ID: ' + options.div);\n                }\n            }\n            else {\n                el = options.div;\n            }\n            if (el && el.appendChild) {\n                el.appendChild(this.node);\n            }\n        }\n    }\n    _setGlyphs(glyphs) {\n        if (glyphs === this._glyphs)\n            return false;\n        this._glyphs = glyphs;\n        this.resize(this._width, this._height);\n        return true;\n    }\n    resize(width, height) {\n        this._width = width;\n        this._height = height;\n        const node = this.node;\n        node.width = this._width * this.tileWidth;\n        node.height = this._height * this.tileHeight;\n    }\n    draw(x, y, glyph, fg, bg) {\n        glyph = glyph & 0xFF;\n        bg = bg & 0xFFF;\n        fg = fg & 0xFFF;\n        const style = (glyph * (1 << 24)) + (bg * (1 << 12)) + fg;\n        this._set(x, y, style);\n    }\n    _requestRender() {\n        if (this._renderRequested)\n            return;\n        this._renderRequested = true;\n        if (!this._autoRender)\n            return;\n        requestAnimationFrame(() => this.render());\n    }\n    _set(x, y, style) {\n        let index = y * this.width + x;\n        const current = this._data[index];\n        if (current !== style) {\n            this._data[index] = style;\n            this._requestRender();\n            return true;\n        }\n        return false;\n    }\n    copy(buffer) {\n        this._data.set(buffer.data);\n        this._requestRender();\n    }\n    copyTo(buffer) {\n        buffer.data.set(this._data);\n    }\n    hasXY(x, y) {\n        return x >= 0 && y >= 0 && x < this.width && y < this.height;\n    }\n    toX(x) {\n        return Math.floor(this.width * x / this.node.clientWidth);\n    }\n    toY(y) {\n        return Math.floor(this.height * y / this.node.clientHeight);\n    }\n}\nexport class Canvas extends BaseCanvas {\n    constructor(options) {\n        super(options);\n    }\n    _createContext() {\n        let gl = this.node.getContext(\"webgl2\");\n        if (!gl) {\n            throw new NotSupportedError(\"WebGL 2 not supported\");\n        }\n        this._gl = gl;\n        this._buffers = {};\n        this._attribs = {};\n        this._uniforms = {};\n        const p = createProgram(gl, shaders.VS, shaders.FS);\n        gl.useProgram(p);\n        const attributeCount = gl.getProgramParameter(p, gl.ACTIVE_ATTRIBUTES);\n        for (let i = 0; i < attributeCount; i++) {\n            gl.enableVertexAttribArray(i);\n            let info = gl.getActiveAttrib(p, i);\n            this._attribs[info.name] = i;\n        }\n        const uniformCount = gl.getProgramParameter(p, gl.ACTIVE_UNIFORMS);\n        for (let i = 0; i < uniformCount; i++) {\n            let info = gl.getActiveUniform(p, i);\n            this._uniforms[info.name] = gl.getUniformLocation(p, info.name);\n        }\n        gl.uniform1i(this._uniforms[\"font\"], 0);\n        this._texture = createTexture(gl);\n    }\n    _createGeometry() {\n        const gl = this._gl;\n        this._buffers.position && gl.deleteBuffer(this._buffers.position);\n        this._buffers.uv && gl.deleteBuffer(this._buffers.uv);\n        let buffers = createGeometry(gl, this._attribs, this.width, this.height);\n        Object.assign(this._buffers, buffers);\n    }\n    _createData() {\n        const gl = this._gl;\n        const attribs = this._attribs;\n        const tileCount = this.width * this.height;\n        this._buffers.style && gl.deleteBuffer(this._buffers.style);\n        this._data = new Uint32Array(tileCount * VERTICES_PER_TILE);\n        const style = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, style);\n        gl.vertexAttribIPointer(attribs[\"style\"], 1, gl.UNSIGNED_INT, 0, 0);\n        Object.assign(this._buffers, { style });\n    }\n    _setGlyphs(glyphs) {\n        if (!super._setGlyphs(glyphs))\n            return false;\n        const gl = this._gl;\n        const uniforms = this._uniforms;\n        gl.uniform2uiv(uniforms[\"tileSize\"], [this.tileWidth, this.tileHeight]);\n        this._uploadGlyphs();\n        return true;\n    }\n    _uploadGlyphs() {\n        if (!this._glyphs.needsUpdate)\n            return;\n        const gl = this._gl;\n        gl.activeTexture(gl.TEXTURE0);\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this._glyphs.node);\n        this._requestRender();\n        this._glyphs.needsUpdate = false;\n    }\n    resize(width, height) {\n        super.resize(width, height);\n        const gl = this._gl;\n        const uniforms = this._uniforms;\n        gl.viewport(0, 0, this.node.width, this.node.height);\n        gl.uniform2ui(uniforms[\"viewportSize\"], this.node.width, this.node.height);\n        this._createGeometry();\n        this._createData();\n    }\n    _set(x, y, style) {\n        let index = y * this.width + x;\n        index *= VERTICES_PER_TILE;\n        const current = this._data[index + 2];\n        if (current !== style) {\n            this._data[index + 2] = style;\n            this._data[index + 5] = style;\n            this._requestRender();\n            return true;\n        }\n        return false;\n    }\n    copy(buffer) {\n        buffer.data.forEach((style, i) => {\n            const index = i * VERTICES_PER_TILE;\n            this._data[index + 2] = style;\n            this._data[index + 5] = style;\n        });\n        this._requestRender();\n    }\n    copyTo(buffer) {\n        const n = this.width * this.height;\n        const dest = buffer.data;\n        for (let i = 0; i < n; ++i) {\n            const index = i * VERTICES_PER_TILE;\n            dest[i] = this._data[index + 2];\n        }\n    }\n    render() {\n        const gl = this._gl;\n        if (this._glyphs.needsUpdate) { // auto keep glyphs up to date\n            this._uploadGlyphs();\n        }\n        else if (!this._renderRequested) {\n            return;\n        }\n        this._renderRequested = false;\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._buffers.style);\n        gl.bufferData(gl.ARRAY_BUFFER, this._data, gl.DYNAMIC_DRAW);\n        gl.drawArrays(gl.TRIANGLES, 0, this._width * this._height * VERTICES_PER_TILE);\n    }\n}\nexport class Canvas2D extends BaseCanvas {\n    constructor(options) {\n        super(options);\n    }\n    _createContext() {\n        const ctx = this.node.getContext('2d');\n        if (!ctx) {\n            throw new NotSupportedError('2d context not supported!');\n        }\n        this._ctx = ctx;\n    }\n    _set(x, y, style) {\n        const result = super._set(x, y, style);\n        if (result) {\n            this._changed[y * this.width + x] = 1;\n        }\n        return result;\n    }\n    resize(width, height) {\n        super.resize(width, height);\n        this._data = new Uint32Array(width * height);\n        this._changed = new Int8Array(width * height);\n    }\n    copy(buffer) {\n        for (let i = 0; i < this._data.length; ++i) {\n            if (this._data[i] !== buffer.data[i]) {\n                this._data[i] = buffer.data[i];\n                this._changed[i] = 1;\n            }\n        }\n        this._requestRender();\n    }\n    render() {\n        this._renderRequested = false;\n        for (let i = 0; i < this._changed.length; ++i) {\n            if (this._changed[i])\n                this._renderCell(i);\n            this._changed[i] = 0;\n        }\n    }\n    _renderCell(index) {\n        const x = index % this.width;\n        const y = Math.floor(index / this.width);\n        const style = this._data[index];\n        const glyph = (style / (1 << 24)) >> 0;\n        const bg = (style >> 12) & 0xFFF;\n        const fg = (style & 0xFFF);\n        const px = x * this.tileWidth;\n        const py = y * this.tileHeight;\n        const gx = (glyph % 16) * this.tileWidth;\n        const gy = Math.floor(glyph / 16) * this.tileHeight;\n        // this._ctx.fillStyle = '#' + bg.toString(16).padStart(3, '0');\n        // this._ctx.fillRect(px, py, this.tileWidth, this.tileHeight);\n        // \n        // this._ctx.fillStyle = '#' + fg.toString(16).padStart(3, '0');\n        // this._ctx.drawImage(this.glyphs.node, gx, gy, this.tileWidth, this.tileHeight, px, py, this.tileWidth, this.tileHeight);\n        const d = this.glyphs.ctx.getImageData(gx, gy, this.tileWidth, this.tileHeight);\n        for (let di = 0; di < d.width * d.height; ++di) {\n            const pct = d.data[di * 4] / 255;\n            const inv = 1.0 - pct;\n            d.data[di * 4 + 0] = pct * (((fg & 0xF00) >> 8) * 17) + inv * (((bg & 0xF00) >> 8) * 17);\n            d.data[di * 4 + 1] = pct * (((fg & 0xF0) >> 4) * 17) + inv * (((bg & 0xF0) >> 4) * 17);\n            d.data[di * 4 + 2] = pct * ((fg & 0xF) * 17) + inv * ((bg & 0xF) * 17);\n            d.data[di * 4 + 3] = 255; // not transparent anymore\n        }\n        this._ctx.putImageData(d, px, py);\n    }\n}\n","export class Glyphs {\n    constructor(opts = {}) {\n        this._tileWidth = 12;\n        this._tileHeight = 16;\n        this.needsUpdate = true;\n        this._map = {};\n        opts.font = opts.font || 'monospace';\n        this._node = document.createElement('canvas');\n        this._ctx = this.node.getContext('2d');\n        this._configure(opts);\n    }\n    static fromImage(src) {\n        if (typeof src === 'string') {\n            if (src.startsWith('data:'))\n                throw new Error('Glyph: You must load a data string into an image element and use that.');\n            const el = document.getElementById(src);\n            if (!el)\n                throw new Error('Glyph: Failed to find image element with id:' + src);\n            src = el;\n        }\n        const glyph = new this({ tileWidth: src.width / 16, tileHeight: src.height / 16 });\n        glyph._ctx.drawImage(src, 0, 0);\n        return glyph;\n    }\n    static fromFont(src) {\n        if (typeof src === 'string') {\n            src = { font: src };\n        }\n        const glyphs = new this(src);\n        const basicOnly = src.basicOnly || src.basic || false;\n        glyphs._initGlyphs(basicOnly);\n        return glyphs;\n    }\n    get node() { return this._node; }\n    get ctx() { return this._ctx; }\n    get tileWidth() { return this._tileWidth; }\n    get tileHeight() { return this._tileHeight; }\n    get pxWidth() { return this._node.width; }\n    get pxHeight() { return this._node.height; }\n    forChar(ch) {\n        if (ch === null || ch === undefined)\n            return -1;\n        return this._map[ch] || -1;\n    }\n    _configure(opts) {\n        this._tileWidth = opts.tileWidth || this.tileWidth;\n        this._tileHeight = opts.tileHeight || this.tileHeight;\n        this.node.width = 16 * this.tileWidth;\n        this.node.height = 16 * this.tileHeight;\n        this._ctx.fillStyle = 'black';\n        this._ctx.fillRect(0, 0, this.pxWidth, this.pxHeight);\n        const size = opts.fontSize || opts.size || Math.max(this.tileWidth, this.tileHeight);\n        this._ctx.font = '' + size + 'px ' + opts.font;\n        this._ctx.textAlign = 'center';\n        this._ctx.textBaseline = 'middle';\n        this._ctx.fillStyle = 'white';\n    }\n    draw(n, ch) {\n        if (n > 256)\n            throw new Error('Cannot draw more than 256 glyphs.');\n        const x = (n % 16) * this.tileWidth;\n        const y = Math.floor(n / 16) * this.tileHeight;\n        const cx = x + Math.floor(this.tileWidth / 2);\n        const cy = y + Math.floor(this.tileHeight / 2);\n        this._ctx.save();\n        this._ctx.beginPath();\n        this._ctx.rect(x, y, this.tileWidth, this.tileHeight);\n        this._ctx.clip();\n        if (typeof ch === 'function') {\n            ch(this._ctx, x, y, this.tileWidth, this.tileHeight);\n        }\n        else {\n            if (this._map[ch] === undefined)\n                this._map[ch] = n;\n            this._ctx.fillText(ch, cx, cy);\n        }\n        this._ctx.restore();\n        this.needsUpdate = true;\n    }\n    _initGlyphs(basicOnly = false) {\n        for (let i = 32; i < 127; ++i) {\n            this.draw(i, String.fromCharCode(i));\n        }\n        if (!basicOnly) {\n            [' ', '\\u263a', '\\u263b', '\\u2665', '\\u2666', '\\u2663', '\\u2660', '\\u263c',\n                '\\u2600', '\\u2605', '\\u2606', '\\u2642', '\\u2640', '\\u266a', '\\u266b', '\\u2638',\n                '\\u25b6', '\\u25c0', '\\u2195', '\\u203c', '\\u204b', '\\u262f', '\\u2318', '\\u2616',\n                '\\u2191', '\\u2193', '\\u2192', '\\u2190', '\\u2126', '\\u2194', '\\u25b2', '\\u25bc',\n            ].forEach((ch, i) => {\n                this.draw(i, ch);\n            });\n            // [\n            // '\\u2302',\n            // '\\u2b09', '\\u272a', '\\u2718', '\\u2610', '\\u2611', '\\u25ef', '\\u25ce', '\\u2690',\n            // '\\u2691', '\\u2598', '\\u2596', '\\u259d', '\\u2597', '\\u2744', '\\u272d', '\\u2727',\n            // '\\u25e3', '\\u25e4', '\\u25e2', '\\u25e5', '\\u25a8', '\\u25a7', '\\u259a', '\\u265f',\n            // '\\u265c', '\\u265e', '\\u265d', '\\u265b', '\\u265a', '\\u301c', '\\u2694', '\\u2692',\n            // '\\u25b6', '\\u25bc', '\\u25c0', '\\u25b2', '\\u25a4', '\\u25a5', '\\u25a6', '\\u257a',\n            // '\\u257b', '\\u2578', '\\u2579', '\\u2581', '\\u2594', '\\u258f', '\\u2595', '\\u272d',\n            // '\\u2591', '\\u2592', '\\u2593', '\\u2503', '\\u252b', '\\u2561', '\\u2562', '\\u2556',\n            // '\\u2555', '\\u2563', '\\u2551', '\\u2557', '\\u255d', '\\u255c', '\\u255b', '\\u2513',\n            // '\\u2517', '\\u253b', '\\u2533', '\\u2523', '\\u2501', '\\u254b', '\\u255e', '\\u255f',\n            // '\\u255a', '\\u2554', '\\u2569', '\\u2566', '\\u2560', '\\u2550', '\\u256c', '\\u2567',\n            // '\\u2568', '\\u2564', '\\u2565', '\\u2559', '\\u2558', '\\u2552', '\\u2553', '\\u256b',\n            // '\\u256a', '\\u251b', '\\u250f', '\\u2588', '\\u2585', '\\u258c', '\\u2590', '\\u2580',\n            // '\\u03b1', '\\u03b2', '\\u0393', '\\u03c0', '\\u03a3', '\\u03c3', '\\u03bc', '\\u03c4',\n            // '\\u03a6', '\\u03b8', '\\u03a9', '\\u03b4', '\\u221e', '\\u03b8', '\\u03b5', '\\u03b7',\n            // '\\u039e', '\\u00b1', '\\u2265', '\\u2264', '\\u2234', '\\u2237', '\\u00f7', '\\u2248',\n            // '\\u22c4', '\\u22c5', '\\u2217', '\\u27b5', '\\u2620', '\\u2625', '\\u25fc', '\\u25fb'\n            // ].forEach( (ch, i) => {\n            //   this.draw(i + 127, ch); \n            // });\n            ['\\u2302',\n                '\\u00C7', '\\u00FC', '\\u00E9', '\\u00E2', '\\u00E4', '\\u00E0', '\\u00E5', '\\u00E7',\n                '\\u00EA', '\\u00EB', '\\u00E8', '\\u00EF', '\\u00EE', '\\u00EC', '\\u00C4', '\\u00C5',\n                '\\u00C9', '\\u00E6', '\\u00C6', '\\u00F4', '\\u00F6', '\\u00F2', '\\u00FB', '\\u00F9',\n                '\\u00FF', '\\u00D6', '\\u00DC', '\\u00A2', '\\u00A3', '\\u00A5', '\\u20A7', '\\u0192',\n                '\\u00E1', '\\u00ED', '\\u00F3', '\\u00FA', '\\u00F1', '\\u00D1', '\\u00AA', '\\u00BA',\n                '\\u00BF', '\\u2310', '\\u00AC', '\\u00BD', '\\u00BC', '\\u00A1', '\\u00AB', '\\u00BB',\n                '\\u2591', '\\u2592', '\\u2593', '\\u2502', '\\u2524', '\\u2561', '\\u2562', '\\u2556',\n                '\\u2555', '\\u2563', '\\u2551', '\\u2557', '\\u255D', '\\u255C', '\\u255B', '\\u2510',\n                '\\u2514', '\\u2534', '\\u252C', '\\u251C', '\\u2500', '\\u253C', '\\u255E', '\\u255F',\n                '\\u255A', '\\u2554', '\\u2569', '\\u2566', '\\u2560', '\\u2550', '\\u256C', '\\u2567',\n                '\\u2568', '\\u2564', '\\u2565', '\\u2559', '\\u2558', '\\u2552', '\\u2553', '\\u256B',\n                '\\u256A', '\\u2518', '\\u250C', '\\u2588', '\\u2584', '\\u258C', '\\u2590', '\\u2580',\n                '\\u03B1', '\\u00DF', '\\u0393', '\\u03C0', '\\u03A3', '\\u03C3', '\\u00B5', '\\u03C4',\n                '\\u03A6', '\\u0398', '\\u03A9', '\\u03B4', '\\u221E', '\\u03C6', '\\u03B5', '\\u2229',\n                '\\u2261', '\\u00B1', '\\u2265', '\\u2264', '\\u2320', '\\u2321', '\\u00F7', '\\u2248',\n                '\\u00B0', '\\u2219', '\\u00B7', '\\u221A', '\\u207F', '\\u00B2', '\\u25A0', '\\u00A0'\n            ].forEach((ch, i) => {\n                this.draw(i + 127, ch);\n            });\n        }\n    }\n}\n","export var options = {\n    random: Math.random.bind(Math),\n    colorLookup: ((_) => null),\n};\nexport function configure(opts = {}) {\n    Object.assign(options, opts);\n}\n","import { options } from './config';\nfunction toColorInt(r = 0, g = 0, b = 0, base256 = false) {\n    if (base256) {\n        r = Math.max(0, Math.min(255, Math.round(r * 2.550001)));\n        g = Math.max(0, Math.min(255, Math.round(g * 2.550001)));\n        b = Math.max(0, Math.min(255, Math.round(b * 2.550001)));\n        return (r << 16) + (g << 8) + b;\n    }\n    r = Math.max(0, Math.min(15, Math.round(r / 100 * 15)));\n    g = Math.max(0, Math.min(15, Math.round(g / 100 * 15)));\n    b = Math.max(0, Math.min(15, Math.round(b / 100 * 15)));\n    return (r << 8) + (g << 4) + b;\n}\nexport class Color extends Int16Array {\n    static fromArray(vals, base256 = false) {\n        while (vals.length < 3)\n            vals.push(0);\n        if (base256) {\n            for (let i = 0; i < 7; ++i) {\n                vals[i] = Math.round((vals[i] || 0) * 100 / 255);\n            }\n        }\n        return new this(...vals);\n    }\n    static fromCss(css) {\n        if (!css.startsWith('#')) {\n            throw new Error('Color CSS strings must be of form \"#abc\" or \"#abcdef\" - received: [' + css + ']');\n        }\n        const c = Number.parseInt(css.substring(1), 16);\n        let r, g, b;\n        if (css.length == 4) {\n            r = Math.round((c >> 8) / 15 * 100);\n            g = Math.round(((c & 0xF0) >> 4) / 15 * 100);\n            b = Math.round((c & 0xF) / 15 * 100);\n        }\n        else {\n            r = Math.round((c >> 16) / 255 * 100);\n            g = Math.round(((c & 0xFF00) >> 8) / 255 * 100);\n            b = Math.round((c & 0xFF) / 255 * 100);\n        }\n        return new this(r, g, b);\n    }\n    static fromNumber(val, base256 = false) {\n        const c = new this();\n        for (let i = 0; i < c.length; ++i) {\n            c[i] = 0;\n        }\n        if (val < 0) {\n            c._r = -1;\n        }\n        else if (base256 || (val > 0xFFF)) {\n            c._r = Math.round(((val & 0xFF0000) >> 16) * 100 / 255);\n            c._g = Math.round(((val & 0xFF00) >> 8) * 100 / 255);\n            c._b = Math.round((val & 0xFF) * 100 / 255);\n        }\n        else {\n            c._r = Math.round(((val & 0xF00) >> 8) * 100 / 15);\n            c._g = Math.round(((val & 0xF0) >> 4) * 100 / 15);\n            c._b = Math.round((val & 0xF) * 100 / 15);\n        }\n        return c;\n    }\n    static make(arg, base256 = false) {\n        if ((arg === undefined) || (arg === null))\n            return new this(-1);\n        if (arg instanceof Color) {\n            return arg.clone();\n        }\n        if (typeof arg === 'string') {\n            const l = options.colorLookup(arg);\n            if (l)\n                return l.clone();\n            return this.fromCss(arg);\n        }\n        else if (Array.isArray(arg)) {\n            return this.fromArray(arg, base256);\n        }\n        else if (typeof arg === 'number') {\n            if (arg < 0)\n                return new this(-1);\n            return this.fromNumber(arg, base256);\n        }\n        throw new Error('Failed to make color - unknown argument: ' + JSON.stringify(arg));\n    }\n    static from(...args) {\n        const arg = args[0];\n        if (arg instanceof Color)\n            return arg;\n        if (arg < 0)\n            return new this(-1);\n        if (typeof arg === 'string') {\n            const l = options.colorLookup(arg);\n            if (l)\n                return l;\n        }\n        return this.make(arg, args[1]);\n    }\n    constructor(r = -1, g = 0, b = 0, rand = 0, redRand = 0, greenRand = 0, blueRand = 0) {\n        super(7);\n        this.set([r, g, b, rand, redRand, greenRand, blueRand]);\n    }\n    get r() { return Math.round(this[0] * 2.550001); }\n    get _r() { return this[0]; }\n    set _r(v) { this[0] = v; }\n    get g() { return Math.round(this[1] * 2.550001); }\n    get _g() { return this[1]; }\n    set _g(v) { this[1] = v; }\n    get b() { return Math.round(this[2] * 2.550001); }\n    get _b() { return this[2]; }\n    set _b(v) { this[2] = v; }\n    get _rand() { return this[3]; }\n    get _redRand() { return this[4]; }\n    get _greenRand() { return this[5]; }\n    get _blueRand() { return this[6]; }\n    // luminosity (0-100)\n    get l() {\n        return Math.round(0.5 * (Math.min(this._r, this._g, this._b) + Math.max(this._r, this._g, this._b)));\n    }\n    // saturation (0-100)\n    get s() {\n        if (this.l >= 100)\n            return 0;\n        return Math.round((Math.max(this._r, this._g, this._b) - Math.min(this._r, this._g, this._b)) * (100 - Math.abs(this.l * 2 - 100)) / 100);\n    }\n    // hue (0-360)\n    get h() {\n        let H = 0;\n        let R = this.r;\n        let G = this.g;\n        let B = this.b;\n        if (R >= G && G >= B) {\n            H = 60 * ((G - B) / (R - B));\n        }\n        else if (G > R && R >= B) {\n            H = 60 * (2 - (R - B) / (G - B));\n        }\n        else if (G >= B && B > R) {\n            H = 60 * (2 + (B - R) / (G - R));\n        }\n        else if (B > G && G > R) {\n            H = 60 * (4 - (G - R) / (B - R));\n        }\n        else if (B > R && R >= G) {\n            H = 60 * (4 + (R - G) / (B - G));\n        }\n        else {\n            H = 60 * (6 - (B - G) / (R - G));\n        }\n        return Math.round(H);\n    }\n    isNull() { return this._r < 0; }\n    equals(other) {\n        if (typeof other === 'string') {\n            return (other.length > 4) ? (this.toString(true) == other) : (this.toString() == other);\n        }\n        else if (typeof other === 'number') {\n            return (this.toInt() == other) || (this.toInt(true) == other);\n        }\n        const O = Color.from(other);\n        if (this.isNull())\n            return O.isNull();\n        return this.every((v, i) => {\n            return v == (O[i] || 0);\n        });\n    }\n    copy(other) {\n        if (Array.isArray(other)) {\n            this.set(other);\n        }\n        else {\n            const O = Color.from(other);\n            this.set(O);\n        }\n        return this;\n    }\n    _changed() {\n        return this;\n    }\n    clone() {\n        // @ts-ignore\n        const other = new this.constructor();\n        other.copy(this);\n        return other;\n    }\n    assign(_r = -1, _g = 0, _b = 0, _rand = 0, _redRand = 0, _greenRand = 0, _blueRand = 0) {\n        for (let i = 0; i < this.length; ++i) {\n            this[i] = (arguments[i] || 0);\n        }\n        return this;\n    }\n    assignRGB(_r = -1, _g = 0, _b = 0, _rand = 0, _redRand = 0, _greenRand = 0, _blueRand = 0) {\n        for (let i = 0; i < this.length; ++i) {\n            this[i] = Math.round((arguments[i] || 0) / 2.55);\n        }\n        return this;\n    }\n    nullify() {\n        this[0] = -1;\n        return this;\n    }\n    blackOut() {\n        for (let i = 0; i < this.length; ++i) {\n            this[i] = 0;\n        }\n        return this;\n    }\n    toInt(base256 = false) {\n        if (this.isNull())\n            return -1;\n        return toColorInt(this._r, this._g, this._b, base256);\n    }\n    clamp() {\n        if (this.isNull())\n            return this;\n        this._r = Math.min(100, Math.max(0, this._r));\n        this._g = Math.min(100, Math.max(0, this._g));\n        this._b = Math.min(100, Math.max(0, this._b));\n        return this._changed();\n    }\n    mix(other, percent) {\n        const O = Color.from(other);\n        if (O.isNull())\n            return this;\n        if (this.isNull()) {\n            this.blackOut();\n        }\n        percent = Math.min(100, Math.max(0, percent));\n        const keepPct = 100 - percent;\n        for (let i = 0; i < this.length; ++i) {\n            this[i] = Math.round(((this[i] * keepPct) + (O[i] * percent)) / 100);\n        }\n        return this._changed();\n    }\n    // Only adjusts r,g,b\n    lighten(percent) {\n        if (this.isNull())\n            return this;\n        percent = Math.min(100, Math.max(0, percent));\n        if (percent <= 0)\n            return;\n        const keepPct = 100 - percent;\n        for (let i = 0; i < 3; ++i) {\n            this[i] = Math.round(((this[i] * keepPct) + (100 * percent)) / 100);\n        }\n        return this._changed();\n    }\n    // Only adjusts r,g,b\n    darken(percent) {\n        if (this.isNull())\n            return this;\n        percent = Math.min(100, Math.max(0, percent));\n        if (percent <= 0)\n            return;\n        const keepPct = 100 - percent;\n        for (let i = 0; i < 3; ++i) {\n            this[i] = Math.round(((this[i] * keepPct) + (0 * percent)) / 100);\n        }\n        return this._changed();\n    }\n    bake() {\n        if (this.isNull())\n            return this;\n        const d = this;\n        if (d[3] + d[4] + d[5] + d[6]) {\n            const rand = this._rand ? Math.floor(options.random() * this._rand) : 0;\n            const redRand = this._redRand ? Math.floor(options.random() * this._redRand) : 0;\n            const greenRand = this._greenRand ? Math.floor(options.random() * this._greenRand) : 0;\n            const blueRand = this._blueRand ? Math.floor(options.random() * this._blueRand) : 0;\n            this._r += (rand + redRand);\n            this._g += (rand + greenRand);\n            this._b += (rand + blueRand);\n            for (let i = 3; i < this.length; ++i) {\n                this[i] = 0;\n            }\n            return this._changed();\n        }\n        return this;\n    }\n    // Adds a color to this one\n    add(other, percent = 100) {\n        const O = Color.from(other);\n        if (O.isNull())\n            return this;\n        if (this.isNull()) {\n            this.blackOut();\n        }\n        for (let i = 0; i < this.length; ++i) {\n            this[i] += Math.round(O[i] * percent / 100);\n        }\n        return this._changed();\n    }\n    scale(percent) {\n        if (this.isNull() || percent == 100)\n            return this;\n        percent = Math.max(0, percent);\n        for (let i = 0; i < this.length; ++i) {\n            this[i] = Math.round(this[i] * percent / 100);\n        }\n        return this._changed();\n    }\n    multiply(other) {\n        if (this.isNull())\n            return this;\n        let data = other;\n        if (!Array.isArray(other)) {\n            if (other.isNull())\n                return this;\n            data = other;\n        }\n        const len = Math.max(3, Math.min(this.length, data.length));\n        for (let i = 0; i < len; ++i) {\n            this[i] = Math.round(this[i] * (data[i] || 0) / 100);\n        }\n        return this._changed();\n    }\n    // scales rgb down to a max of 100\n    normalize() {\n        if (this.isNull())\n            return this;\n        const max = Math.max(this._r, this._g, this._b);\n        if (max <= 100)\n            return this;\n        this._r = Math.round(100 * this._r / max);\n        this._g = Math.round(100 * this._g / max);\n        this._b = Math.round(100 * this._b / max);\n        return this._changed();\n    }\n    css(base256 = false) {\n        const d = this;\n        let v = 0;\n        if (d[3] + d[4] + d[5] + d[6]) {\n            const rand = this._rand ? Math.floor(options.random() * this._rand) : 0;\n            const redRand = this._redRand ? Math.floor(options.random() * this._redRand) : 0;\n            const greenRand = this._greenRand ? Math.floor(options.random() * this._greenRand) : 0;\n            const blueRand = this._blueRand ? Math.floor(options.random() * this._blueRand) : 0;\n            const red = (this._r + rand + redRand);\n            const green = (this._g + rand + greenRand);\n            const blue = (this._b + rand + blueRand);\n            v = toColorInt(red, green, blue, base256);\n        }\n        else {\n            v = this.toInt(base256);\n        }\n        return '#' + v.toString(16).padStart(base256 ? 6 : 3, '0');\n    }\n    toString(base256 = false) {\n        if (this.isNull())\n            return 'null color';\n        return '#' + this.toInt(base256).toString(16).padStart(base256 ? 6 : 3, '0');\n    }\n    // adjusts the luminosity of 2 colors to ensure there is enough separation between them\n    static separate(a, b) {\n        if (a.isNull() || b.isNull())\n            return;\n        const A = a.clone().clamp();\n        const B = b.clone().clamp();\n        // console.log('separate');\n        // console.log('- a=%s, h=%d, s=%d, l=%d', A.toString(), A.h, A.s, A.l);\n        // console.log('- b=%s, h=%d, s=%d, l=%d', B.toString(), B.h, B.s, B.l);\n        let hDiff = Math.abs(A.h - B.h);\n        if (hDiff > 180) {\n            hDiff = 360 - hDiff;\n        }\n        if (hDiff > 45)\n            return; // colors are far enough apart in hue to be distinct\n        const dist = 40;\n        if (Math.abs(A.l - B.l) >= dist)\n            return;\n        // Get them sorted by saturation ( we will darken the more saturated color and lighten the other)\n        const [lo, hi] = [A, B].sort((a, b) => a.s - b.s);\n        // console.log('- lo=%s, hi=%s', lo.toString(), hi.toString());\n        while ((hi.l - lo.l) < dist) {\n            hi.mix(WHITE, 5);\n            lo.mix(BLACK, 5);\n        }\n        a.copy(A);\n        b.copy(B);\n        // console.log('=>', a.toString(), b.toString());\n    }\n}\nconst BLACK = new Color(0, 0, 0);\nconst WHITE = new Color(100, 100, 100);\n","import { Color } from './color';\n;\nexport class DataBuffer {\n    constructor(width, height) {\n        this._width = width;\n        this._height = height;\n        this._data = new Uint32Array(width * height);\n    }\n    get data() { return this._data; }\n    get width() { return this._width; }\n    get height() { return this._height; }\n    get(x, y) {\n        let index = y * this.width + x;\n        const style = this._data[index] || 0;\n        const glyph = (style >> 24);\n        const bg = (style >> 12) & 0xFFF;\n        const fg = (style & 0xFFF);\n        return { glyph, fg, bg };\n    }\n    _toGlyph(ch) {\n        if (ch === null || ch === undefined)\n            return -1;\n        return ch.charCodeAt(0);\n    }\n    draw(x, y, glyph = -1, fg = -1, bg = -1) {\n        let index = y * this.width + x;\n        const current = this._data[index] || 0;\n        if (typeof glyph !== 'number') {\n            glyph = this._toGlyph(glyph);\n        }\n        if (typeof fg !== 'number') {\n            fg = Color.from(fg).toInt();\n        }\n        if (typeof bg !== 'number') {\n            bg = Color.from(bg).toInt();\n        }\n        glyph = (glyph >= 0) ? (glyph & 0xFF) : (current >> 24);\n        bg = (bg >= 0) ? (bg & 0xFFF) : ((current >> 12) & 0xFFF);\n        fg = (fg >= 0) ? (fg & 0xFFF) : (current & 0xFFF);\n        const style = (glyph << 24) + (bg << 12) + fg;\n        this._data[index] = style;\n        return this;\n    }\n    // This is without opacity - opacity must be done in Mixer\n    drawSprite(x, y, sprite) {\n        const glyph = sprite.ch ? sprite.ch : sprite.glyph;\n        // const fg = sprite.fg ? sprite.fg.toInt() : -1;\n        // const bg = sprite.bg ? sprite.bg.toInt() : -1;\n        return this.draw(x, y, glyph, sprite.fg, sprite.bg);\n    }\n    blackOut(x, y) {\n        if (arguments.length == 0) {\n            return this.fill(0, 0, 0);\n        }\n        return this.draw(x, y, 0, 0, 0);\n    }\n    fill(glyph = 0, fg = 0xFFF, bg = 0) {\n        if (typeof glyph == 'string') {\n            glyph = this._toGlyph(glyph);\n        }\n        glyph = glyph & 0xFF;\n        fg = fg & 0xFFF;\n        bg = bg & 0xFFF;\n        const style = (glyph << 24) + (bg << 12) + fg;\n        this._data.fill(style);\n        return this;\n    }\n    copy(other) {\n        this._data.set(other._data);\n        return this;\n    }\n}\nexport class Buffer extends DataBuffer {\n    constructor(canvas) {\n        super(canvas.width, canvas.height);\n        this._canvas = canvas;\n        canvas.copyTo(this);\n    }\n    // get canvas() { return this._canvas; }\n    _toGlyph(ch) {\n        return this._canvas.glyphs.forChar(ch);\n    }\n    render() {\n        this._canvas.copy(this);\n        return this;\n    }\n    copyFromCanvas() {\n        this._canvas.copyTo(this);\n        return this;\n    }\n}\n","import { Color } from './color';\nexport class Mixer {\n    constructor() {\n        this.ch = -1;\n        this.fg = new Color();\n        this.bg = new Color();\n    }\n    _changed() {\n        return this;\n    }\n    copy(other) {\n        this.ch = other.ch;\n        this.fg.copy(other.fg);\n        this.bg.copy(other.bg);\n        return this._changed();\n    }\n    clone() {\n        const other = new Mixer();\n        other.copy(this);\n        return other;\n    }\n    nullify() {\n        this.ch = -1;\n        this.fg.nullify();\n        this.bg.nullify();\n        return this._changed();\n    }\n    blackOut() {\n        this.ch = 0;\n        this.fg.blackOut();\n        this.bg.blackOut();\n        return this._changed();\n    }\n    draw(ch = -1, fg = -1, bg = -1) {\n        if (ch && (ch !== -1)) {\n            this.ch = ch;\n        }\n        if ((fg !== -1) && (fg !== null)) {\n            fg = Color.from(fg);\n            this.fg.copy(fg);\n        }\n        if ((bg !== -1) && (bg !== null)) {\n            bg = Color.from(bg);\n            this.bg.copy(bg);\n        }\n        return this._changed();\n    }\n    drawSprite(info, opacity) {\n        if (opacity === undefined)\n            opacity = info.opacity;\n        if (opacity === undefined)\n            opacity = 100;\n        if (opacity <= 0)\n            return;\n        if (info.ch)\n            this.ch = info.ch;\n        else if (info.glyph !== undefined)\n            this.ch = info.glyph;\n        if (info.fg)\n            this.fg.mix(info.fg, opacity);\n        if (info.bg)\n            this.bg.mix(info.bg, opacity);\n        return this._changed();\n    }\n    invert() {\n        [this.bg, this.fg] = [this.fg, this.bg];\n        return this._changed();\n    }\n    multiply(color, fg = true, bg = true) {\n        color = Color.from(color);\n        if (fg) {\n            this.fg.multiply(color);\n        }\n        if (bg) {\n            this.bg.multiply(color);\n        }\n        return this._changed();\n    }\n    mix(color, fg = 50, bg = fg) {\n        color = Color.from(color);\n        if (fg > 0) {\n            this.fg.mix(color, fg);\n        }\n        if (bg > 0) {\n            this.bg.mix(color, bg);\n        }\n        return this._changed();\n    }\n    add(color, fg = 100, bg = fg) {\n        color = Color.from(color);\n        if (fg > 0) {\n            this.fg.add(color, fg);\n        }\n        if (bg > 0) {\n            this.bg.add(color, bg);\n        }\n        return this._changed();\n    }\n    separate() {\n        Color.separate(this.fg, this.bg);\n        return this._changed();\n    }\n    bake() {\n        this.fg.bake();\n        this.bg.bake();\n        this._changed();\n        return {\n            ch: this.ch,\n            fg: this.fg.toInt(),\n            bg: this.bg.toInt(),\n        };\n    }\n}\n","import { Canvas, Canvas2D, NotSupportedError } from \"./canvas\";\nimport { Glyphs } from \"./glyphs\";\nimport { Buffer, DataBuffer } from './buffer';\nimport { Color } from './color';\nimport { Mixer } from './mixer';\nimport { configure } from './config';\nfunction withImage(image) {\n    let opts = {};\n    if (typeof image === 'string') {\n        opts.glyphs = Glyphs.fromImage(image);\n    }\n    else if (image instanceof HTMLImageElement) {\n        opts.glyphs = Glyphs.fromImage(image);\n    }\n    else {\n        if (!image.image)\n            throw new Error('You must supply the image.');\n        Object.assign(opts, image);\n        opts.glyphs = Glyphs.fromImage(image.image);\n    }\n    let canvas;\n    try {\n        canvas = new Canvas(opts);\n    }\n    catch (e) {\n        if (!(e instanceof NotSupportedError))\n            throw e;\n    }\n    if (!canvas) {\n        canvas = new Canvas2D(opts);\n    }\n    return canvas;\n}\nfunction withFont(src) {\n    if (typeof src === 'string') {\n        src = { font: src };\n    }\n    src.glyphs = Glyphs.fromFont(src);\n    let canvas;\n    try {\n        canvas = new Canvas(src);\n    }\n    catch (e) {\n        if (!(e instanceof NotSupportedError))\n            throw e;\n    }\n    if (!canvas) {\n        canvas = new Canvas2D(src);\n    }\n    return canvas;\n}\nexport { Canvas, Canvas2D, Glyphs, Buffer, DataBuffer, Color, Mixer, withImage, withFont, configure, NotSupportedError, };\n"],"names":["QUAD","VS","trim","FS","NotSupportedError","Error","[object Object]","params","super","captureStackTrace","this","name","BaseCanvas","options","_renderRequested","_autoRender","_width","_height","glyphs","_node","_createNode","_createContext","_configure","node","width","height","tileWidth","_glyphs","tileHeight","pxWidth","clientWidth","pxHeight","clientHeight","_setGlyphs","document","createElement","render","div","el","getElementById","console","warn","appendChild","resize","x","y","glyph","fg","bg","style","_set","requestAnimationFrame","index","_data","_requestRender","buffer","set","data","Math","floor","Canvas","gl","getContext","_gl","_buffers","_attribs","_uniforms","p","sources","createProgram","VERTEX_SHADER","FRAGMENT_SHADER","forEach","type","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","shaders.VS","shaders.FS","useProgram","attributeCount","ACTIVE_ATTRIBUTES","i","enableVertexAttribArray","info","getActiveAttrib","uniformCount","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","uniform1i","_texture","t","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","position","deleteBuffer","uv","buffers","attribs","tileCount","positionData","Uint16Array","length","uvData","Uint8Array","value","createBuffer","bindBuffer","ARRAY_BUFFER","vertexAttribIPointer","UNSIGNED_SHORT","bufferData","STATIC_DRAW","UNSIGNED_BYTE","createGeometry","Object","assign","Uint32Array","UNSIGNED_INT","uniforms","uniform2uiv","_uploadGlyphs","needsUpdate","activeTexture","TEXTURE0","texImage2D","RGBA","viewport","uniform2ui","_createGeometry","_createData","n","dest","DYNAMIC_DRAW","drawArrays","TRIANGLES","Canvas2D","ctx","_ctx","result","_changed","Int8Array","_renderCell","px","py","gx","gy","d","getImageData","di","pct","inv","putImageData","Glyphs","opts","_tileWidth","_tileHeight","_map","font","src","startsWith","drawImage","basicOnly","basic","_initGlyphs","ch","fillStyle","fillRect","size","fontSize","max","textAlign","textBaseline","cx","cy","save","beginPath","rect","clip","undefined","fillText","restore","draw","String","fromCharCode","random","bind","colorLookup","_","toColorInt","r","g","b","base256","min","round","Color","Int16Array","vals","push","css","c","Number","parseInt","substring","val","_r","_g","_b","arg","clone","l","fromCss","Array","isArray","fromArray","fromNumber","JSON","stringify","args","make","rand","redRand","greenRand","blueRand","v","_rand","_redRand","_greenRand","_blueRand","s","abs","h","H","R","G","B","other","toString","toInt","O","from","isNull","every","constructor","copy","arguments","percent","blackOut","keepPct","len","padStart","a","A","clamp","hDiff","lo","hi","sort","mix","WHITE","BLACK","DataBuffer","charCodeAt","current","_toGlyph","sprite","fill","Mixer","nullify","opacity","color","multiply","add","separate","bake","canvas","_canvas","copyTo","forChar","image","fromImage","HTMLImageElement","e","fromFont"],"mappings":"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"}